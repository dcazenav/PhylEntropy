<!-- import math, itertools

def table(labels):
	count = labels.count
	return [count(item) for item in set(labels)]


def diShannon(tx):
	s = sum(tx)
	tx = [x /float(s) for x in tx]
	return - sum([x*math.log(x) for x in tx])


def diSimpson(tx):
	nn = sum(tx)
	return sum([x * (x-1) for x in tx])/ float(nn* (nn-1))

out = []

for n in range(14):
	# between 1 and 17 responses
	for resp in range(16):
		lx = itertools.combinations_with_replacement(range(n+2), resp+2)
		for x in lx:
			tx = table(x)

			r = (diShannon(tx),diSimpson(tx))
			if not r in out:
				out.append(r)
				print n,resp,r[0],r[1]
-->


	 {% block content %}
	 <!-- <script src="http://visjs.org/dist/vis.js"></script> -->
	 <script src="https://unpkg.com/vis-network@9.1.0/standalone/umd/vis-network.min.js"></script>
     <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
     <script src="https://code.jquery.com/jquery-3.5.1.js"></script>

	 <!-- <link href="http://visjs.org/dist/vis.css" rel="stylesheet" type="text/css" /> -->
	 <link href="https://unpkg.com/browse/vis-network@9.1.0/styles/vis-network.min.css" rel="stylesheet" type="text/css" />
	 <link rel="stylesheet" href="../static/css/bootstrap.min.css">


   <style>
   #hunter-gaston
   {
		   background-color: #ffffff;
		   text-align: center;


   }

   #mylegend {
	 float: left;
	 width: 400px;
	 height: 600px;
   }
   </style>
   {% endblock%}
   {%block javascripts %}

   <script type="text/javascript">

   var table= {{minimal_tree | safe}};

   labelSeq={{label_reduce | safe}};
   var nodes=[];
   var dico= new Map();
   
   var firstcolumn = window.opener.parent.array.length ;
   var reachID = window.opener.parent.array[window.opener.parent.array.length-firstcolumn];
   var lastItem = window.opener.parent.array[window.opener.parent.array.length-2];


	// DÃ©but HGDI
    var retrievedObject = localStorage.getItem('TableauduCSV');

damienitem = JSON.parse(retrievedObject).length

var hdgi1 = [];
var hdgi2 = [];

for (var i = 0; i < damienitem; i++) { 
  damien = JSON.parse(retrievedObject)[i];

	var numberstraintested = damien.length ;
	var difftypenum = [], count = 0;
  var numberstrainpertype = {};
  
  if(difftypenum[damien] == undefined) {
    	    difftypenum[damien] = 1;
      	  count++;
    	}

	
	damien.forEach(function (x) { numberstrainpertype[x] = (numberstrainpertype[x] || 0) + 1; });

	for (const [key, value] of Object.entries(numberstrainpertype)) {
  	  console.log(`${key}: ${value}`);
    	sumStrain(numberstrainpertype[`${key}`])
    	//sum =  ${value} ;
	}

	function sumStrain(a){
  	  var total=0;
    	for(var k in a) {
      	  total += a[k]*(a[k]-1);
    	}
    	return total;
	}
	
  
  
	var SumNumbDiffStrain = sumStrain(numberstrainpertype) ;
  
  hdgi1.push(1 / (numberstraintested * (numberstraintested-1)));

  hdgi2.push(1-(hdgi1[i] * SumNumbDiffStrain));
  
  

}
// Fin HGDI

$(document).ready(function () {
    $('#example').DataTable({
        data: hdgi2,
    });
});


       //window.alert(hdgi2);


   </script>

   <div class="container-fluid" style="background-color: #a6aaa9;" >
	   <div class="col-lg-10" style="float:none;margin:auto;background-color: #ffffff;">
        <div class="container">
            <div id="tab_data" class="row" style="position: relative; overflow: scroll; width: 100%; max-height: 700px; height: 700px;">
                <form  id="form1" autocomplete="off" method="POST" action="">
                    {% csrf_token %}
                    <table id="example" class="display" cellspacing="0">
                    {% for row in fichier %}
                    {% if forloop.first %}
        
                        <thead>
                             <tr>    
                                {% for column in row %}
                                    <th>{{column}}</th>
                                {% endfor %}
                            </tr>
                        </thead>

                        <tbody>
                            {% else %}
                            <tr>
                            {% for column in row %}
                                <td>{{column}}</td>
                            {% endfor %}
                            </tr>
                            {% endif %}
                            {% endfor %}
                        </tbody>
                        

                    </table>
                </form>
            </div>
        </div>
       </div>
   </div>
   {% endblock %}

		 <div id="hunter-gaston" style="text-align: center;">
             HGDI : <script type="text/javascript">
            document.write(hdgi2)
         </script>
         </div>
   

   </div>
   </div>
 
